---
data_dir: /tmp/
sinks:
  console:
    type: console
    inputs: 
      - transorms.syslog
sources:
  stdin:
    type: stdin
transforms:
  syslog:
    inputs:
      - sources.stdin
    source: ". |= parse_syslog!(.message)\nstructured = parse_groks(\n    .message,\n
      \   [ \"%{LMOD:lmod}\", \"%{SSH_MSG:ssh}\", \"%{MODULECMD_MSG:modulecmd}\",
      \"%{NFS_MSG:nfs}\", \"%{OPENNEBULA_MSG:one}\", \"%{QUATTOR_MSG:quattor}\", \"%{SNOOPY_MSG:snoopy}\"],\n
      \   alias_sources: [ \n        \"/tmp/grok/gpfs.json\",\n        \"/tmp/grok/icinga.json\",\n
      \       \"/tmp/grok/lmod.json\",\n        \"/tmp/grok/modulecmd.json\",\n
      \       \"/tmp/grok/nfs.json\",\n        \"/tmp/grok/opennebula.json\",\n
      \       \"/tmp/grok/quattor.json\",\n        \"/tmp/grok/shorewall.json\",\n
      \       \"/tmp/grok/snoopy.json\",\n        \"/tmp/grok/ssh.json\",\n
      \       \"/tmp/grok/hpc-ugent-patterns.json\",\n    ],\n) ?? { \"message\":
      .message, \"grokparsefailure\": true }\n. = merge(., structured)"
    type: remap
